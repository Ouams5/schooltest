<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bni Yekhlef High School â€” Auth System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Poppins Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Poppins', sans-serif;
  background: #f6f7fb;
  margin: 0;
  padding: 40px;
}

.container {
  max-width: 500px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.08);
}

h2, h3 {
  margin-top: 0;
  font-weight: 600;
}

input {
  width: 100%;
  padding: 12px;
  margin: 6px 0 15px;
  border-radius: 8px;
  border: 1px solid #d7d7d7;
  font-size: 14px;
}

button {
  width: 100%;
  padding: 12px;
  background: #1a73e8;
  border: none;
  color: white;
  font-size: 15px;
  font-weight: 600;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 5px;
}

button:hover {
  opacity: .92;
}

#logoutBtn {
  background: #e65151;
}

/* Notification popup */
#notifBox {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #fff;
  padding: 14px 18px;
  border-radius: 8px;
  box-shadow: 0 5px 18px rgba(0,0,0,0.12);
  opacity: 0;
  transition: opacity .3s ease;
  font-weight: 500;
  min-width: 200px;
}

.success { border-left: 4px solid #10b981; }
.error   { border-left: 4px solid #ef4444; }
.warning { border-left: 4px solid #f59e0b; }

</style>
</head>
<body>

<div id="notifBox"></div>

<div class="container">
  <h2>Bni Yekhlef High School</h2>
  <p id="authStatus"><strong>Status:</strong> Not logged in</p>

  <hr><br>

  <h3>Register</h3>
  <input id="regEmail" type="email" placeholder="Email">
  <input id="regPass" type="password" placeholder="Password">
  <button id="registerBtn">Create Account</button>

  <br><hr><br>

  <h3>Login</h3>
  <input id="logEmail" type="email" placeholder="Email">
  <input id="logPass" type="password" placeholder="Password">
  <button id="loginBtn">Login</button>

  <br><br>
  <button id="logoutBtn">Logout</button>
</div>

<!-- Firebase (Modular) -->
<script type="module">

/* -----------------------------
   Firebase Imports
------------------------------*/
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
  getAuth, createUserWithEmailAndPassword, 
  signInWithEmailAndPassword, signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { 
  getFirestore, doc, setDoc 
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* -----------------------------
   Firebase Config (YOURS)
------------------------------*/
const firebaseConfig = {
  apiKey: "AIzaSyD6ha3-iiXidoa0KnB9PuA0fnlqDUkcV2g",
  authDomain: "bniyekhlef-high-school.firebaseapp.com",
  projectId: "bniyekhlef-high-school",
  storageBucket: "bniyekhlef-high-school.firebasestorage.app",
  messagingSenderId: "807833913334",
  appId: "1:807833913334:web:a5eb4e2b96c0c32f2169d7",
  measurementId: "G-QCWNGXXRPP"
};

/* -----------------------------
   Initialize Firebase
------------------------------*/
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* -----------------------------
   Notification System
------------------------------*/
function notify(text, type = "success") {
  const box = document.getElementById("notifBox");
  box.textContent = text;
  box.className = type;
  box.style.opacity = 1;
  setTimeout(() => box.style.opacity = 0, 3000);
}

/* -----------------------------
   Register User
------------------------------*/
async function registerUser() {
  const email = document.getElementById("regEmail").value;
  const pass = document.getElementById("regPass").value;

  try {
    const cred = await createUserWithEmailAndPassword(auth, email, pass);

    await setDoc(doc(db, "users", cred.user.uid), {
      email: email,
      createdAt: new Date()
    });

    notify("Account created successfully!", "success");
  } 
  catch (err) {
    notify(err.message, "error");
  }
}

/* -----------------------------
   Login User
------------------------------*/
async function loginUser() {
  const email = document.getElementById("logEmail").value;
  const pass = document.getElementById("logPass").value;

  try {
    await signInWithEmailAndPassword(auth, email, pass);
    notify("Logged in!", "success");
  } 
  catch (err) {
    notify(err.message, "error");
  }
}

/* -----------------------------
   Logout User
------------------------------*/
async function logoutUser() {
  await signOut(auth);
  notify("Logged out", "warning");
}

/* -----------------------------
   Auth State Listener
------------------------------*/
onAuthStateChanged(auth, user => {
  const status = document.getElementById("authStatus");

  if (user) {
    status.innerHTML = `<strong>Status:</strong> Logged in as ${user.email}`;
  } else {
    status.innerHTML = `<strong>Status:</strong> Not logged in`;
  }
});

/* -----------------------------
   Hook Buttons
------------------------------*/
document.getElementById("registerBtn").onclick = registerUser;
document.getElementById("loginBtn").onclick = loginUser;
document.getElementById("logoutBtn").onclick = logoutUser;

</script>
</body>
</html>
